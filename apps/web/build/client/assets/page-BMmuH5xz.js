import"./index-BBR7LY95.js";import{r as m,o as e,w as F}from"./chunk-OIYGIGL5-CHh4hLy7.js";import{R as w}from"./layout-fLsGi43P.js";import{C as r}from"./PolymorphicComponent-BTRAlSaW.js";import{u,L as v}from"./loader-circle-BiXf0MZp.js";import{A as B}from"./arrow-left-B5a6TF-H.js";import{H as C}from"./home-BjfbSmrq.js";import{B as D,C as A}from"./chevron-down-CBML68P_.js";import{P as S}from"./plus-BK-3pfPJ.js";import{S as z}from"./search-B4nYVHJk.js";import{B as T}from"./building-2-BSOjs4at.js";import{F as P}from"./filter-DNH2c2QO.js";import{C as _}from"./circle-alert-DgKs_Yk2.js";import{F as $}from"./file-text-CoEZokur.js";import{C as O,I as W}from"./indian-rupee-yqKnPTb1.js";import{M as R}from"./map-pin-Cqfw8YRB.js";if(typeof window<"u"){const s={};globalThis.process??={};const o=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},s,o),{get(a,c){return c in a?a[c]:void 0},has(){return!0}})}function L(){const[s,o]=m.useState(""),[a,c]=m.useState(""),[l,g]=m.useState(""),{data:x,isLoading:j,error:h}=u({queryKey:["work-orders",s],queryFn:async()=>{try{const d=new URLSearchParams;s&&d.append("search",s);const t=await fetch(`/api/work-orders?${d}`);if(!t.ok)throw new Error(`Failed to fetch work orders: ${t.status} ${t.statusText}`);return await t.json()}catch(d){throw console.error("Error fetching work orders:",d),d}},retry:3,retryDelay:1e3}),{data:b,error:U}=u({queryKey:["companies"],queryFn:async()=>{try{const d=await fetch("/api/companies");if(!d.ok)throw new Error(`Failed to fetch companies: ${d.status} ${d.statusText}`);return await d.json()}catch(d){throw console.error("Error fetching companies:",d),d}},retry:3,retryDelay:1e3}),k=Array.isArray(x?.workOrders)?x.workOrders:[],E=Array.isArray(b?.companies)?b.companies:[],i=k.filter(d=>{if(!d)return!1;const t=!a||d.company_name&&d.company_name===a,n=!l||d.status&&d.status===l;return t&&n}),N=d=>{if(!d)return e.jsx(r,{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-500 text-white",renderId:"render-5b18ecbe",as:"span",children:"Unknown"});const t={Draft:{bg:"bg-[#9CA3AF] dark:bg-[#6B7280]",text:"text-white"},"In Progress":{bg:"bg-[#F59E0B] dark:bg-[#D97706]",text:"text-white"},Completed:{bg:"bg-[#10B981] dark:bg-[#059669]",text:"text-white"},Active:{bg:"bg-[#3B82F6] dark:bg-[#2563EB]",text:"text-white"}},n=t[d]||t.Draft;return e.jsx(r,{className:`px-2 py-1 rounded-full text-xs font-medium ${n.bg} ${n.text}`,renderId:"render-39f2c972",as:"span",children:d})},f=d=>{if(!d||isNaN(d))return"Rs. 0";try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d)}catch(t){return console.error("Error formatting currency:",t),"Rs. 0"}},I=d=>{if(!d)return"N/A";try{return new Date(d).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch(t){return console.error("Error formatting date:",t),"Invalid Date"}},y=()=>i.reduce((d,t)=>{if(!t||!t.net_amount)return d;const n=parseFloat(t.net_amount);return d+(isNaN(n)?0:n)},0),p=d=>i.filter(t=>t&&t.status===d).length;return e.jsxs(r,{className:"min-h-screen bg-[#F6F8FA] dark:bg-[#121212]",renderId:"render-22297bb7",as:"div",children:[e.jsxs(r,{className:"bg-[#0C8657] dark:bg-[#0C8657] h-14 flex items-center px-4 sm:px-6 text-white sticky top-0 z-30",renderId:"render-e4ce02b3",as:"header",children:[e.jsxs(r,{className:"flex items-center gap-2",renderId:"render-4c93cab5",as:"div",children:[e.jsxs(r,{onClick:()=>window.history.back(),className:"flex items-center gap-2 hover:bg-white/10 dark:hover:bg-white/10 active:bg-white/20 dark:active:bg-white/20 px-2 py-1 rounded transition-colors",renderId:"render-2709d18b",as:"button",children:[e.jsx(B,{size:20}),e.jsx(r,{className:"hidden sm:block",renderId:"render-1244b7ff",as:"span",children:"Back"})]}),e.jsxs(r,{onClick:()=>window.location.href="/dashboard",className:"flex items-center gap-2 hover:bg-white/10 dark:hover:bg-white/10 active:bg-white/20 dark:active:bg-white/20 px-2 py-1 rounded transition-colors",title:"Go to Dashboard",renderId:"render-ee76fa55",as:"button",children:[e.jsx(C,{size:20}),e.jsx(r,{className:"hidden sm:block",renderId:"render-f91ac1f3",as:"span",children:"Dashboard"})]})]}),e.jsx(r,{className:"text-xl font-semibold ml-4",renderId:"render-519c6434",as:"h1",children:"Work Orders"}),e.jsxs(r,{className:"flex items-center gap-2 sm:gap-4 ml-auto",renderId:"render-9d7b3080",as:"div",children:[e.jsxs(r,{className:"relative hover:bg-white/10 dark:hover:bg-white/10 active:bg-white/20 dark:active:bg-white/20 p-1 rounded transition-colors",renderId:"render-7954f07f",as:"button",children:[e.jsx(D,{size:20}),e.jsx(r,{className:"absolute -top-1 -right-1 w-3 h-3 bg-[#FFD83B] dark:bg-[#FCD34D] rounded-full",renderId:"render-b1352b7d",as:"div"})]}),e.jsxs(r,{className:"hidden sm:flex items-center gap-2 cursor-pointer hover:bg-white/10 dark:hover:bg-white/10 active:bg-white/20 dark:active:bg-white/20 px-2 py-1 rounded transition-colors",renderId:"render-eadada21",as:"button",children:[e.jsx(r,{src:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=32&h=32&fit=crop&crop=face&auto=format",alt:"User Avatar",className:"w-8 h-8 rounded-full",renderId:"render-6d956de0",as:"img"}),e.jsx(r,{className:"hidden md:block",renderId:"render-928efdc7",as:"span",children:"Admin User"}),e.jsx(A,{size:16})]})]})]}),e.jsxs(r,{className:"max-w-7xl mx-auto p-6",renderId:"render-bab668be",as:"main",children:[e.jsxs(r,{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-6",renderId:"render-4aaf9ef8",as:"div",children:[e.jsx(r,{className:"text-2xl font-semibold text-[#1F2739] dark:text-[#FFFFFF]",renderId:"render-6cafb5d0",as:"h1",children:"All Work Orders"}),e.jsxs(r,{onClick:()=>window.location.href="/work-orders/create",className:"flex items-center gap-2 px-4 py-2 bg-[#0C8657] dark:bg-[#059669] text-white rounded-lg hover:bg-[#0a6b47] dark:hover:bg-[#047857] transition-colors",renderId:"render-1a5e41d2",as:"button",children:[e.jsx(S,{size:16}),e.jsx(r,{renderId:"render-709c2f03",as:"span",children:"Create New Work Order"})]})]}),e.jsx(r,{className:"bg-white dark:bg-[#1E1E1E] rounded-lg border border-[#E4E8EE] dark:border-[#333333] p-4 mb-6",renderId:"render-84739743",as:"div",children:e.jsxs(r,{className:"grid grid-cols-1 md:grid-cols-3 gap-4",renderId:"render-20707e1a",as:"div",children:[e.jsxs(r,{className:"relative",renderId:"render-a43f442a",as:"div",children:[e.jsx(z,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[#9DA5BC] dark:text-[#888888]"}),e.jsx(r,{type:"text",placeholder:"Search by WO number or vendor name...",value:s,onChange:d=>o(d.target.value),className:"w-full pl-10 pr-4 py-2 border border-[#E4E8EE] dark:border-[#333333] rounded-lg bg-white dark:bg-[#262626] text-[#1F2739] dark:text-[#FFFFFF] focus:outline-none focus:ring-2 focus:ring-[#0C8657] dark:focus:ring-[#22C55E]",renderId:"render-693a5738",as:"input"})]}),e.jsxs(r,{className:"relative",renderId:"render-552b5899",as:"div",children:[e.jsx(T,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[#9DA5BC] dark:text-[#888888] z-10"}),e.jsxs(r,{value:a,onChange:d=>c(d.target.value),className:"w-full pl-10 pr-4 py-2 border border-[#E4E8EE] dark:border-[#333333] rounded-lg bg-white dark:bg-[#262626] text-[#1F2739] dark:text-[#FFFFFF] focus:outline-none focus:ring-2 focus:ring-[#0C8657] dark:focus:ring-[#22C55E] appearance-none",renderId:"render-2a3e9446",as:"select",children:[e.jsx(r,{value:"",renderId:"render-1c1cb297",as:"option",children:"All Companies"}),E.map(d=>e.jsx(r,{value:d.company_name||"",renderId:"render-1cabb4b0",as:"option",children:d.company_name||"Unknown Company"},d.id||d.company_name))]})]}),e.jsxs(r,{className:"relative",renderId:"render-1feb4b8a",as:"div",children:[e.jsx(P,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[#9DA5BC] dark:text-[#888888] z-10"}),e.jsxs(r,{value:l,onChange:d=>g(d.target.value),className:"w-full pl-10 pr-4 py-2 border border-[#E4E8EE] dark:border-[#333333] rounded-lg bg-white dark:bg-[#262626] text-[#1F2739] dark:text-[#FFFFFF] focus:outline-none focus:ring-2 focus:ring-[#0C8657] dark:focus:ring-[#22C55E] appearance-none",renderId:"render-f9348370",as:"select",children:[e.jsx(r,{value:"",renderId:"render-f0732b9b",as:"option",children:"All Status"}),e.jsx(r,{value:"Draft",renderId:"render-5410290f",as:"option",children:"Draft"}),e.jsx(r,{value:"Active",renderId:"render-d2429b75",as:"option",children:"Active"}),e.jsx(r,{value:"In Progress",renderId:"render-06ca838c",as:"option",children:"In Progress"}),e.jsx(r,{value:"Completed",renderId:"render-c3ef935c",as:"option",children:"Completed"})]})]})]})}),e.jsx(r,{className:"bg-white dark:bg-[#1E1E1E] rounded-lg border border-[#E4E8EE] dark:border-[#333333] overflow-hidden",renderId:"render-5ec4ed76",as:"div",children:j?e.jsx(r,{className:"flex items-center justify-center py-12",renderId:"render-556a0928",as:"div",children:e.jsx(v,{size:32,className:"text-[#0C8657] dark:text-[#22C55E] animate-spin"})}):h?e.jsx(r,{className:"flex items-center justify-center py-12",renderId:"render-ac1dde29",as:"div",children:e.jsxs(r,{className:"text-center",renderId:"render-99ae7ba1",as:"div",children:[e.jsx(_,{size:32,className:"text-[#E95D5D] dark:text-[#EF4444] mx-auto mb-2"}),e.jsx(r,{className:"text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-b0996f65",as:"p",children:h.message||"Failed to load work orders"})]})}):i.length===0?e.jsx(r,{className:"flex items-center justify-center py-12",renderId:"render-d3a37476",as:"div",children:e.jsxs(r,{className:"text-center",renderId:"render-1165b687",as:"div",children:[e.jsx($,{size:32,className:"text-[#9DA5BC] dark:text-[#888888] mx-auto mb-2"}),e.jsx(r,{className:"text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-dd47b4ec",as:"p",children:s||a||l?"No work orders found matching your filters":"No work orders found"})]})}):e.jsx(r,{className:"overflow-x-auto",renderId:"render-60f74301",as:"div",children:e.jsxs(r,{className:"w-full",renderId:"render-b82fe874",as:"table",children:[e.jsx(r,{className:"bg-[#F7FAFC] dark:bg-[#262626] border-b border-[#E4E8EE] dark:border-[#333333]",renderId:"render-7301db16",as:"thead",children:e.jsxs(r,{renderId:"render-fbc87633",as:"tr",children:[e.jsx(r,{className:"text-left py-3 px-4 font-medium text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-f4a1018e",as:"th",children:"WO Number"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-78f3fdec",as:"th",children:"Date"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-29e36801",as:"th",children:"Vendor Name"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-86ddfdf9",as:"th",children:"Site Name"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-f4cd7843",as:"th",children:"Net Amount"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-d5ef16b8",as:"th",children:"Status"})]})}),e.jsx(r,{renderId:"render-9b823eeb",as:"tbody",children:i.map(d=>e.jsxs(r,{className:"border-b border-[#E4E8EE] dark:border-[#333333] hover:bg-[#F7FAFC] dark:hover:bg-[#262626] transition-colors",renderId:"render-f4db0db4",as:"tr",children:[e.jsx(r,{className:"py-3 px-4",renderId:"render-2e7ba281",as:"td",children:e.jsx(r,{onClick:()=>window.location.href=`/work-orders/${d?.id||""}`,className:"text-[#0C8657] dark:text-[#22C55E] hover:underline font-medium",renderId:"render-ceda8d04",as:"button",children:d?.wo_number||"N/A"})}),e.jsx(r,{className:"py-3 px-4 text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-c52a2589",as:"td",children:e.jsxs(r,{className:"flex items-center gap-1",renderId:"render-fdadf677",as:"div",children:[e.jsx(O,{size:14}),I(d?.date)]})}),e.jsx(r,{className:"py-3 px-4 text-[#1F2739] dark:text-[#FFFFFF]",renderId:"render-dcccdc88",as:"td",children:d?.vendor_name||"N/A"}),e.jsx(r,{className:"py-3 px-4 text-[#5D667E] dark:text-[#B0B0B0]",renderId:"render-c47357e9",as:"td",children:e.jsxs(r,{className:"flex items-center gap-1",renderId:"render-c682f442",as:"div",children:[e.jsx(R,{size:14}),d?.site_name||"N/A"]})}),e.jsx(r,{className:"py-3 px-4 text-[#1F2739] dark:text-[#FFFFFF] font-semibold",renderId:"render-6eb2c8b9",as:"td",children:e.jsxs(r,{className:"flex items-center gap-1",renderId:"render-bcefd691",as:"div",children:[e.jsx(W,{size:14}),f(d?.net_amount).replace("₹","")]})}),e.jsx(r,{className:"py-3 px-4",renderId:"render-51ca9d62",as:"td",children:N(d?.status)})]},d?.id||Math.random()))})]})})}),i.length>0&&e.jsxs(r,{className:"mt-6 grid grid-cols-1 md:grid-cols-4 gap-4",renderId:"render-4462b950",as:"div",children:[e.jsxs(r,{className:"bg-white dark:bg-[#1E1E1E] rounded-lg border border-[#E4E8EE] dark:border-[#333333] p-4",renderId:"render-c797ef4f",as:"div",children:[e.jsx(r,{className:"text-sm font-medium text-[#5D667E] dark:text-[#B0B0B0] mb-1",renderId:"render-9c964864",as:"h3",children:"Total Work Orders"}),e.jsx(r,{className:"text-2xl font-bold text-[#1F2739] dark:text-[#FFFFFF]",renderId:"render-f8d8c94b",as:"p",children:i.length})]}),e.jsxs(r,{className:"bg-white dark:bg-[#1E1E1E] rounded-lg border border-[#E4E8EE] dark:border-[#333333] p-4",renderId:"render-1e4c7687",as:"div",children:[e.jsx(r,{className:"text-sm font-medium text-[#5D667E] dark:text-[#B0B0B0] mb-1",renderId:"render-4d59d9c8",as:"h3",children:"Total Value"}),e.jsx(r,{className:"text-2xl font-bold text-[#0C8657] dark:text-[#22C55E]",renderId:"render-966f1f0f",as:"p",children:f(y())})]}),e.jsxs(r,{className:"bg-white dark:bg-[#1E1E1E] rounded-lg border border-[#E4E8EE] dark:border-[#333333] p-4",renderId:"render-a6b01b81",as:"div",children:[e.jsx(r,{className:"text-sm font-medium text-[#5D667E] dark:text-[#B0B0B0] mb-1",renderId:"render-bd252d7b",as:"h3",children:"Draft Orders"}),e.jsx(r,{className:"text-2xl font-bold text-[#9CA3AF] dark:text-[#6B7280]",renderId:"render-14ecf696",as:"p",children:p("Draft")})]}),e.jsxs(r,{className:"bg-white dark:bg-[#1E1E1E] rounded-lg border border-[#E4E8EE] dark:border-[#333333] p-4",renderId:"render-cf7ac4ef",as:"div",children:[e.jsx(r,{className:"text-sm font-medium text-[#5D667E] dark:text-[#B0B0B0] mb-1",renderId:"render-16e027ed",as:"h3",children:"Completed Orders"}),e.jsx(r,{className:"text-2xl font-bold text-[#10B981] dark:text-[#059669]",renderId:"render-0dbba109",as:"p",children:p("Completed")})]})]})]})]})}if(typeof window<"u"){const s={};globalThis.process??={};const o=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},s,o),{get(a,c){return c in a?a[c]:void 0},has(){return!0}})}const ae=F(function(o){return e.jsx(w,{children:e.jsx(L,{...o})})});export{ae as default};
