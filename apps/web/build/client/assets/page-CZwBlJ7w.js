import"./index-BBR7LY95.js";import{r as p,o as e,w as E}from"./chunk-OIYGIGL5-CHh4hLy7.js";import{R as $}from"./layout-fLsGi43P.js";import{C as r}from"./PolymorphicComponent-BTRAlSaW.js";import{F}from"./FullScreenError-C7yZdfBZ.js";import{c as I,u,L as S}from"./loader-circle-BiXf0MZp.js";import{H as L}from"./home-BjfbSmrq.js";import{B as j}from"./building-2-BSOjs4at.js";import{F as c}from"./file-text-CoEZokur.js";import{C as R,U as M,S as _,M as B}from"./users-DksgO1ys.js";import{C as y,B as U}from"./chevron-down-CBML68P_.js";import{A as V}from"./activity-KnUNH4iM.js";import{C as q}from"./circle-alert-DgKs_Yk2.js";import{I as N,C as H}from"./indian-rupee-yqKnPTb1.js";import{P as Q}from"./plus-BK-3pfPJ.js";import{E as K}from"./eye-8sa-d4vC.js";if(typeof window<"u"){const t={};globalThis.process??={};const o=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},t,o),{get(n,a){return a in n?n[a]:void 0},has(){return!0}})}const G=I("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);if(typeof window<"u"){const t={};globalThis.process??={};const o=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},t,o),{get(n,a){return a in n?n[a]:void 0},has(){return!0}})}const J=I("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);if(typeof window<"u"){const t={};globalThis.process??={};const o=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},t,o),{get(n,a){return a in n?n[a]:void 0},has(){return!0}})}function X(){const[t,o]=p.useState(!0),[n,a]=p.useState({"work-orders":!0}),v=s=>{a(d=>({...d,[s]:!d[s]}))},{data:x,isLoading:w,error:m}=u({queryKey:["work-orders"],queryFn:async()=>{try{const s=await fetch("/api/work-orders");if(!s.ok)throw new Error(`Failed to fetch work orders: ${s.status} ${s.statusText}`);return await s.json()}catch(s){throw console.error("Error fetching work orders:",s),s}},retry:3,retryDelay:1e3}),{data:g,isLoading:k,error:f}=u({queryKey:["companies"],queryFn:async()=>{try{const s=await fetch("/api/companies");if(!s.ok)throw new Error(`Failed to fetch companies: ${s.status} ${s.statusText}`);return await s.json()}catch(s){throw console.error("Error fetching companies:",s),s}},retry:3,retryDelay:1e3});if(m||f)return e.jsx(F,{message:`Error loading dashboard: ${m?.message||f?.message||"Unknown error"}`});const i=Array.isArray(x?.workOrders)?x.workOrders:[];Array.isArray(g?.companies)&&g.companies;const C=i.length,A=i.filter(s=>s&&(s.status==="In Progress"||s.status==="Active")).length,z=i.filter(s=>s&&s.status==="Draft").length,D=i.reduce((s,d)=>{if(!d||!d.net_amount)return s;const l=parseFloat(d.net_amount);return s+(isNaN(l)?0:l)},0),O={Draft:i.filter(s=>s&&s.status==="Draft").length,"In Progress":i.filter(s=>s&&s.status==="In Progress").length,Active:i.filter(s=>s&&s.status==="Active").length,Completed:i.filter(s=>s&&s.status==="Completed").length},h=i.filter(s=>s&&s.id&&s.created_at).sort((s,d)=>{const l=new Date(s.created_at);return new Date(d.created_at)-l}).slice(0,5),b=s=>!s||isNaN(s)?"Rs. 0":new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),P=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch(d){return console.error("Error formatting date:",d),"Invalid Date"}},T=s=>{if(!s)return e.jsx(r,{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-500 text-white",renderId:"render-a2c2f18a",as:"span",children:"Unknown"});const d={Draft:{bg:"bg-gray-500",text:"text-white"},"In Progress":{bg:"bg-yellow-500",text:"text-white"},Completed:{bg:"bg-green-500",text:"text-white"},Active:{bg:"bg-blue-500",text:"text-white"}},l=d[s]||d.Draft;return e.jsx(r,{className:`px-2 py-1 rounded-full text-xs font-medium ${l.bg} ${l.text}`,renderId:"render-3130b316",as:"span",children:s})},W=s=>s&&{Draft:"bg-gray-500","In Progress":"bg-yellow-500",Completed:"bg-green-500",Active:"bg-blue-500"}[s]||"bg-gray-500";return e.jsxs(r,{className:"min-h-screen bg-gray-50 flex",renderId:"render-4132469c",as:"div",children:[t&&e.jsx(r,{className:"fixed lg:relative inset-y-0 left-0 z-50 bg-white w-64 flex-shrink-0 border-r border-gray-200 flex flex-col",renderId:"render-734dc48f",as:"div",children:e.jsx(r,{className:"flex-1 overflow-y-auto",renderId:"render-53b29d53",as:"div",children:e.jsxs(r,{className:"p-4 space-y-2",renderId:"render-9abfd00c",as:"nav",children:[e.jsxs(r,{className:"flex items-center gap-3 px-3 py-2 bg-green-50 text-green-700 rounded-lg",renderId:"render-019f9d54",as:"div",children:[e.jsx(L,{size:16,className:"text-green-700"}),e.jsx(r,{className:"font-semibold",renderId:"render-d3e76f6e",as:"span",children:"Dashboard"})]}),e.jsxs(r,{onClick:()=>window.location.href="/companies",className:"flex items-center gap-3 px-3 py-2 text-gray-600 hover:bg-green-50 hover:text-green-700 rounded-lg cursor-pointer transition-colors",renderId:"render-533a7868",as:"div",children:[e.jsx(j,{size:16,className:"text-green-700"}),e.jsx(r,{className:"font-medium",renderId:"render-3a328595",as:"span",children:"Companies"})]}),e.jsxs(r,{renderId:"render-21ea48f6",as:"div",children:[e.jsxs(r,{className:`flex items-center gap-3 px-3 py-2 cursor-pointer rounded-lg transition-colors ${n["work-orders"]?"bg-green-50":"hover:bg-green-50"}`,onClick:()=>v("work-orders"),renderId:"render-99976b5d",as:"div",children:[e.jsx(c,{size:16,className:"text-green-700"}),e.jsx(r,{className:"font-semibold text-green-700 flex-1",renderId:"render-dd8d4cf6",as:"span",children:"Work Orders"}),n["work-orders"]?e.jsx(R,{size:14,className:"text-gray-600"}):e.jsx(y,{size:14,className:"text-gray-600"})]}),n["work-orders"]&&e.jsxs(r,{className:"ml-6 mt-2 space-y-1 bg-green-50 p-2 rounded-lg",renderId:"render-fb252dcc",as:"div",children:[e.jsx(r,{onClick:()=>window.location.href="/work-orders/create",className:"px-3 py-2 text-gray-600 text-sm cursor-pointer hover:text-green-700 hover:bg-green-100 rounded transition-colors",renderId:"render-91a7b1e6",as:"div",children:"Create Work Order"}),e.jsx(r,{onClick:()=>window.location.href="/work-orders",className:"px-3 py-2 text-gray-600 text-sm cursor-pointer hover:text-green-700 hover:bg-green-100 rounded transition-colors",renderId:"render-bdea2fce",as:"div",children:"Work Order List"}),e.jsx(r,{className:"px-3 py-2 text-gray-600 text-sm cursor-pointer hover:text-green-700 hover:bg-green-100 rounded transition-colors",renderId:"render-d8d3b484",as:"div",children:"Pending Payments"})]})]}),e.jsxs(r,{onClick:()=>window.location.href="/vendors",className:"flex items-center gap-3 px-3 py-2 text-gray-600 hover:bg-green-50 hover:text-green-700 rounded-lg cursor-pointer transition-colors",renderId:"render-3f655c2f",as:"div",children:[e.jsx(M,{size:16,className:"text-green-700"}),e.jsx(r,{className:"font-medium flex-1",renderId:"render-54af2cd6",as:"span",children:"Vendors"})]}),e.jsxs(r,{onClick:()=>window.location.href="/activity-logs",className:"flex items-center gap-3 px-3 py-2 text-gray-600 hover:bg-green-50 hover:text-green-700 rounded-lg cursor-pointer transition-colors",renderId:"render-6ded8617",as:"div",children:[e.jsx(V,{size:16,className:"text-green-700"}),e.jsx(r,{className:"font-medium flex-1",renderId:"render-7bdfe8d7",as:"span",children:"Activity Log"})]}),e.jsxs(r,{className:"flex items-center gap-3 px-3 py-2 text-gray-600 hover:bg-green-50 hover:text-green-700 rounded-lg cursor-pointer transition-colors",renderId:"render-b2892748",as:"div",children:[e.jsx(_,{size:16,className:"text-green-700"}),e.jsx(r,{className:"font-medium flex-1",renderId:"render-c17f1920",as:"span",children:"Settings"})]})]})})}),t&&e.jsx(r,{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>o(!1),renderId:"render-034aebbd",as:"div"}),e.jsxs(r,{className:"flex-1 flex flex-col min-w-0",renderId:"render-703de8a8",as:"div",children:[e.jsxs(r,{className:"bg-green-600 h-14 flex items-center px-4 sm:px-6 text-white sticky top-0 z-30",renderId:"render-14507bd7",as:"header",children:[e.jsx(r,{className:"flex items-center gap-4",renderId:"render-1e2a9bbb",as:"div",children:e.jsx(r,{className:"hover:bg-white/10 p-2 rounded transition-colors",onClick:()=>o(!t),renderId:"render-e89c0b16",as:"button",children:e.jsx(B,{size:24})})}),e.jsx(r,{className:"flex-1 flex justify-center",renderId:"render-56699b47",as:"div",children:e.jsx(r,{className:"text-xl font-semibold text-white",renderId:"render-c4e9978e",as:"h1",children:"Work Order Management System"})}),e.jsxs(r,{className:"flex items-center gap-2 sm:gap-4",renderId:"render-c24930c5",as:"div",children:[e.jsxs(r,{className:"relative hover:bg-white/10 p-2 rounded transition-colors",renderId:"render-80328f26",as:"button",children:[e.jsx(U,{size:24}),e.jsx(r,{className:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full",renderId:"render-27bfce98",as:"div"})]}),e.jsxs(r,{className:"hidden sm:flex items-center gap-2 cursor-pointer hover:bg-white/10 px-3 py-2 rounded transition-colors",renderId:"render-dab1e3d7",as:"button",children:[e.jsx(r,{src:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=32&h=32&fit=crop&crop=face&auto=format",alt:"User Avatar",className:"w-8 h-8 rounded-full",renderId:"render-b790346c",as:"img"}),e.jsx(r,{className:"hidden md:block",renderId:"render-74b92af1",as:"span",children:"Admin User"}),e.jsx(y,{size:20})]})]})]}),e.jsx(r,{className:"flex-1 p-6 bg-gray-50",renderId:"render-11c94caa",as:"main",children:e.jsxs(r,{className:"max-w-7xl mx-auto",renderId:"render-d43287c7",as:"div",children:[e.jsxs(r,{className:"mb-8",renderId:"render-b6e33605",as:"div",children:[e.jsx(r,{className:"text-3xl font-bold text-gray-900 mb-2",renderId:"render-ceb7a52e",as:"h1",children:"Dashboard"}),e.jsx(r,{className:"text-gray-600",renderId:"render-7dfccfd5",as:"p",children:"Welcome back! Here's what's happening with your work orders."})]}),w||k?e.jsx(r,{className:"flex items-center justify-center py-12",renderId:"render-42334a54",as:"div",children:e.jsx(S,{size:32,className:"text-green-600 animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsxs(r,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",renderId:"render-3c9ad059",as:"div",children:[e.jsx(r,{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 border border-blue-200",renderId:"render-9fca131f",as:"div",children:e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-96967bf0",as:"div",children:[e.jsxs(r,{renderId:"render-a1896b5d",as:"div",children:[e.jsx(r,{className:"text-blue-700 text-sm font-medium",renderId:"render-86b5003f",as:"p",children:"Total Work Orders"}),e.jsx(r,{className:"text-3xl font-bold text-blue-800 mt-2",renderId:"render-3bcf210e",as:"p",children:C}),e.jsx(r,{className:"text-blue-600 text-xs mt-1",renderId:"render-c2525b03",as:"p",children:"All Time"})]}),e.jsx(r,{className:"bg-blue-200 p-3 rounded-full",renderId:"render-998b9932",as:"div",children:e.jsx(c,{size:24,className:"text-blue-700"})})]})}),e.jsx(r,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg p-6 border border-yellow-200",renderId:"render-2049d4e8",as:"div",children:e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-f85e4ddf",as:"div",children:[e.jsxs(r,{renderId:"render-dcd62ee6",as:"div",children:[e.jsx(r,{className:"text-yellow-700 text-sm font-medium",renderId:"render-16f778f0",as:"p",children:"Active Work Orders"}),e.jsx(r,{className:"text-3xl font-bold text-yellow-800 mt-2",renderId:"render-12bafb12",as:"p",children:A}),e.jsx(r,{className:"text-yellow-600 text-xs mt-1",renderId:"render-bef038b5",as:"p",children:"Currently Active"})]}),e.jsx(r,{className:"bg-yellow-200 p-3 rounded-full",renderId:"render-5b24ee7b",as:"div",children:e.jsx(J,{size:24,className:"text-yellow-700"})})]})}),e.jsx(r,{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-6 border border-orange-200",renderId:"render-6d32f4b3",as:"div",children:e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-b876eafd",as:"div",children:[e.jsxs(r,{renderId:"render-3239a22d",as:"div",children:[e.jsx(r,{className:"text-orange-700 text-sm font-medium",renderId:"render-71cad86e",as:"p",children:"Pending Approvals"}),e.jsx(r,{className:"text-3xl font-bold text-orange-800 mt-2",renderId:"render-18b6d032",as:"p",children:z}),e.jsx(r,{className:"text-orange-600 text-xs mt-1",renderId:"render-1edf9b7c",as:"p",children:"Awaiting Action"})]}),e.jsx(r,{className:"bg-orange-200 p-3 rounded-full",renderId:"render-3cf20e64",as:"div",children:e.jsx(q,{size:24,className:"text-orange-700"})})]})}),e.jsx(r,{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 border border-green-200",renderId:"render-e9284b2b",as:"div",children:e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-1611b449",as:"div",children:[e.jsxs(r,{renderId:"render-8279e330",as:"div",children:[e.jsx(r,{className:"text-green-700 text-sm font-medium",renderId:"render-c7f50c1d",as:"p",children:"Total Value"}),e.jsx(r,{className:"text-3xl font-bold text-green-800 mt-2",renderId:"render-5a3910d6",as:"p",children:b(D).replace("₹","Rs. ")}),e.jsx(r,{className:"text-green-600 text-xs mt-1",renderId:"render-d39f652e",as:"p",children:"Total Pipeline"})]}),e.jsx(r,{className:"bg-green-200 p-3 rounded-full",renderId:"render-87ca4a55",as:"div",children:e.jsx(N,{size:24,className:"text-green-700"})})]})})]}),e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6 mb-8",renderId:"render-bdaeed17",as:"div",children:[e.jsx(r,{className:"text-lg font-semibold text-gray-900 mb-4",renderId:"render-e44c4f56",as:"h2",children:"Quick Actions"}),e.jsxs(r,{className:"flex flex-col sm:flex-row gap-4",renderId:"render-23df3f44",as:"div",children:[e.jsxs(r,{onClick:()=>window.location.href="/work-orders/create",className:"flex items-center justify-center gap-3 px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium text-lg flex-1 sm:flex-none",renderId:"render-5be2b1f7",as:"button",children:[e.jsx(Q,{size:20}),e.jsx(r,{renderId:"render-ab242d15",as:"span",children:"Create New Work Order"})]}),e.jsxs(r,{onClick:()=>window.location.href="/companies",className:"flex items-center justify-center gap-3 px-6 py-4 bg-white border-2 border-gray-200 text-gray-900 rounded-lg hover:bg-gray-50 transition-colors font-medium",renderId:"render-fb238b28",as:"button",children:[e.jsx(j,{size:20}),e.jsx(r,{renderId:"render-2eca5e29",as:"span",children:"Manage Companies"})]}),e.jsxs(r,{onClick:()=>window.location.href="/work-orders",className:"flex items-center justify-center gap-3 px-6 py-4 bg-white border-2 border-gray-200 text-gray-900 rounded-lg hover:bg-gray-50 transition-colors font-medium",renderId:"render-ec751898",as:"button",children:[e.jsx(K,{size:20}),e.jsx(r,{renderId:"render-86992819",as:"span",children:"View All Work Orders"})]})]})]}),e.jsxs(r,{className:"grid lg:grid-cols-5 gap-8",renderId:"render-dbc3a0e8",as:"div",children:[e.jsx(r,{className:"lg:col-span-3",renderId:"render-c41ff94b",as:"div",children:e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-9a7e1802",as:"div",children:[e.jsxs(r,{className:"flex items-center justify-between mb-6",renderId:"render-1ec62f51",as:"div",children:[e.jsx(r,{className:"text-lg font-semibold text-gray-900",renderId:"render-3abb8157",as:"h2",children:"Recent Work Orders"}),e.jsxs(r,{onClick:()=>window.location.href="/work-orders",className:"flex items-center gap-2 text-green-600 hover:text-green-700 transition-colors text-sm font-medium",renderId:"render-9f2fe131",as:"button",children:[e.jsx(r,{renderId:"render-61c8fb82",as:"span",children:"View All"}),e.jsx(G,{size:16})]})]}),h.length===0?e.jsxs(r,{className:"text-center py-8",renderId:"render-641b9dc9",as:"div",children:[e.jsx(c,{size:32,className:"text-gray-400 mx-auto mb-2"}),e.jsx(r,{className:"text-gray-600",renderId:"render-f07ef89b",as:"p",children:"No work orders found"})]}):e.jsx(r,{className:"overflow-x-auto",renderId:"render-ca9e3c84",as:"div",children:e.jsxs(r,{className:"w-full",renderId:"render-d8457b7e",as:"table",children:[e.jsx(r,{className:"bg-gray-50 border-b border-gray-200",renderId:"render-097abeeb",as:"thead",children:e.jsxs(r,{renderId:"render-c6360416",as:"tr",children:[e.jsx(r,{className:"text-left py-3 px-4 font-medium text-gray-600 text-sm",renderId:"render-edc7f420",as:"th",children:"WO Number"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-gray-600 text-sm",renderId:"render-a3b56ce3",as:"th",children:"Vendor Name"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-gray-600 text-sm",renderId:"render-a6cad606",as:"th",children:"Date"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-gray-600 text-sm",renderId:"render-1b083821",as:"th",children:"Net Amount"}),e.jsx(r,{className:"text-left py-3 px-4 font-medium text-gray-600 text-sm",renderId:"render-f8addcd7",as:"th",children:"Status"})]})}),e.jsx(r,{renderId:"render-0cdbf73a",as:"tbody",children:h.map(s=>e.jsxs(r,{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",renderId:"render-fe5c18da",as:"tr",children:[e.jsx(r,{className:"py-3 px-4",renderId:"render-91b25600",as:"td",children:e.jsx(r,{onClick:()=>window.location.href=`/work-orders/${s.id}`,className:"text-green-600 hover:underline font-medium text-sm",renderId:"render-5246b0e6",as:"button",children:s.wo_number||"N/A"})}),e.jsx(r,{className:"py-3 px-4 text-gray-900 text-sm",renderId:"render-56964f9d",as:"td",children:s.vendor_name||"N/A"}),e.jsx(r,{className:"py-3 px-4 text-gray-600 text-sm",renderId:"render-0fda7e20",as:"td",children:e.jsxs(r,{className:"flex items-center gap-1",renderId:"render-f947b334",as:"div",children:[e.jsx(H,{size:12}),P(s.date)]})}),e.jsx(r,{className:"py-3 px-4 text-gray-900 font-semibold text-sm",renderId:"render-1788024c",as:"td",children:e.jsxs(r,{className:"flex items-center gap-1",renderId:"render-4681d02d",as:"div",children:[e.jsx(N,{size:12}),b(s.net_amount).replace("₹","").replace(".00","")]})}),e.jsx(r,{className:"py-3 px-4",renderId:"render-ccaae773",as:"td",children:T(s.status)})]},s.id))})]})})]})}),e.jsx(r,{className:"lg:col-span-2",renderId:"render-ee17a7d0",as:"div",children:e.jsxs(r,{className:"bg-white rounded-lg border border-gray-200 p-6",renderId:"render-d95d8e57",as:"div",children:[e.jsx(r,{className:"text-lg font-semibold text-gray-900 mb-6",renderId:"render-c309e4d2",as:"h2",children:"Status Overview"}),e.jsx(r,{className:"space-y-4",renderId:"render-417a2b1c",as:"div",children:Object.entries(O).map(([s,d])=>e.jsxs(r,{className:"flex items-center justify-between",renderId:"render-74cde294",as:"div",children:[e.jsxs(r,{className:"flex items-center gap-3",renderId:"render-c8345593",as:"div",children:[e.jsx(r,{className:`w-3 h-3 rounded-full ${W(s)}`,renderId:"render-c183dcf8",as:"div"}),e.jsx(r,{className:"text-gray-900 font-medium",renderId:"render-332ae756",as:"span",children:s})]}),e.jsx(r,{className:"bg-gray-50 px-3 py-1 rounded-full",renderId:"render-91884499",as:"div",children:e.jsx(r,{className:"text-gray-900 font-bold",renderId:"render-48ea8bda",as:"span",children:d})})]},s))})]})})]})]})]})})]})]})}if(typeof window<"u"){const t={};globalThis.process??={};const o=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},t,o),{get(n,a){return a in n?n[a]:void 0},has(){return!0}})}const he=E(function(o){return e.jsx($,{children:e.jsx(X,{...o})})});export{he as default};
